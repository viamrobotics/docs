---
title: "Configure a Smart Machine"
linkTitle: "Configure a Machine"
weight: 30
type: "docs"
description: "Before you can program a machine, you must configure its components and services as well as any modules, remotes, processes and frames."
image: "/get-started/installation/thumbnails/configure.svg"
imageAlt: "Configure a Machine"
images: ["/get-started/installation/thumbnails/configure.svg"]
tags: ["manage", "components"]
aliases:
  - /manage/configuration/
---

Before you can program a smart machine, you must configure it.

A machine's configuration tells the code running the machine what _{{< glossary_tooltip term_id="resource" text="resources" >}}_ (hardware _{{< glossary_tooltip term_id="component" text="components" >}}_ and software _{{< glossary_tooltip term_id="service" text="services" >}}_) it has access to, as well as any relevant parameters for those resources.

To start configuring, go to the [Viam app](https://app.viam.com), create a new machine and follow the steps on your new machineâ€™s **Setup** tab.

The setup steps copy your machine's credentials to your machine and store them at <file>/etc/viam.json</file>.
The credentials look like this:

```json
{
  "cloud": {
    "app_address": "https://app.viam.com:123",
    "id": "123456ab-a1b2-12a3-a123-1a2b345cdefg6",
    "secret": "LOCATION SECRET FROM THE VIAM APP"
  }
}
```

When you turn on your machine, `viam-server` starts up and, by default, it uses the credentials in its local <file>/etc/viam.json</file> to fetch its full config from the [Viam app](https://app.viam.com).
Once the machine has a configuration, it caches it locally and can use the configuration for up to 60 days.
The machine checks for new configurations every 15 seconds and changes its configuration automatically when a new configuration is available.
All communication happens securely over HTTPS using secret tokens that are in a machine's configuration.

{{< alert title="Tip" color="tip" >}}
You can also store your config file in a custom location if desired. See [Run `viam-server`](/get-started/installation/manage/#run-viam-server) for more information.
{{< /alert >}}

After you have completed the setup steps and successfully connected to your machine, go to the **Config** tab to start adding to the configuration.

{{% alert title="Info" color="info" %}}

Your machine does not need to stay connected to the Viam app after it has obtained its configuration file.
The configuration is cached locally.
If your machine will never connect to the internet, you can also create a [local configuration file](/internals/local-configuration-file/) on the machine itself.
{{% /alert %}}

## The Config tab

The **Config** tab on the [Viam app](https://app.viam.com) is the place to configure everything about your machine.

You can use the mode selector to switch between **Builder** and **Raw JSON**:

- **Builder** mode provides a graphical interface for configuring your machine resources.
- **Raw JSON** mode provides a text editing field where you can write and edit the config manually.

![The CONFIG tab of the Viam app with a box highlighting the CONFIG tab and the Mode selector (where you can select Builder or Raw JSON).](/build/configure/config-tab.png)

Regardless of the mode you choose, Viam stores the configuration file in [JSON (JavaScript Object Notation)](https://en.wikipedia.org/wiki/JSON).

{{< alert title="Caution: Simultaneous config edits" color="caution" >}}
If you edit a config while someone else edits the same config, the person who saves last will overwrite any prior changes that aren't reflected in the new config.

Before editing a config, we recommend you refresh the page to ensure you have all the latest changes.
{{< /alert >}}

If you add components in **Builder** mode and click **Save Config** at the bottom of the screen, you can switch to **Raw JSON** and see the JSON that has been generated by the builder.

{{% expand "An example config file for a machine with a board component, motor component, camera component, and vision service configured" %}}

```json
{
  "components": [
    {
      "name": "local",
      "model": "pi",
      "type": "board",
      "namespace": "rdk",
      "attributes": {},
      "depends_on": []
    },
    {
      "name": "my-motor",
      "model": "gpio",
      "type": "motor",
      "namespace": "rdk",
      "attributes": {
        "pins": {
          "a": "13",
          "b": "15"
        },
        "board": "local",
        "max_rpm": 120
      },
      "depends_on": []
    },
    {
      "name": "my_camera",
      "model": "webcam",
      "type": "camera",
      "namespace": "rdk",
      "attributes": {
        "video_path": "video0"
      }
    }
  ],
  "services": [
    {
      "name": "detector",
      "type": "vision",
      "attributes": {
        "register_models": [
          {
            "parameters": {
              "segment_size_px": 200,
              "hue_tolerance_pct": 0.05,
              "detect_color": "#19FFD9"
            },
            "type": "color_detector",
            "name": "green_detector"
          }
        ]
      }
    }
  ],
  "modules": []
}
```

See [Example JSON configuration file](/internals/local-configuration-file/#example-json-configuration-file) for an additional example.

{{% /expand %}}

The **Config** tab has subtabs for each section of your machine's config:

- [Components](#components): Components are the hardware of your machine.
- [Services](#services): Services are the software that runs on your machine.
- [Modules](#modules): {{< glossary_tooltip term_id="module" text="Modules" >}} provide {{< glossary_tooltip term_id="modular-resource" text="modular resources" >}}, which are a way to add resource types or models that are not built into Viam.
- [Remotes](#remotes): Remotes are a way to connect two separate machines so one can access the resources of the other.
- [Processes](#processes): Processes automatically run specified scripts when the machine boots.
- [Fragments](#fragments): Fragments are a way of sharing and managing identical configuration files (or parts of config files) across multiple machines.
- [Auth/Network](#authnetwork): The auth and network section allows you to configure machine-level API keys and set a bind address for `viam-server`.
- [Frames](#frame-system): Frames hold reference frame information for the relative position of components in space.

{{% alert title="Tip" color="tip" %}}

Simple machines often use only a few components (and perhaps services).
Depending on your machine, you may not need to configure any modules, remotes, processes, fragments or frames.

See [Build a simple smart machine](/use-cases/configure/) for a quick overview.

{{% /alert %}}

## Components

Components represent the pieces of hardware on your machine that you want to control with Viam.

You must configure each component with a type, a model, a name, attributes, and dependencies:

- `type`: The broad component category, such as `motor`, `arm` or `camera`.
  Components of a given type have a common API.

- `model`: Indicates the more specific category of hardware.
  Components of the same model are supported using the same low-level code.

- `name`: Serves as an identifier when accessing the resource from your code, as well as when configuring other resources that are dependent on that resource.
  You can choose any unique name for a component.

- `attributes`: A struct to define things like how the component is wired to the machine, its dimensions, and other specifications; attributes vary widely between models.
  See the [component documentation](/components/) for a given component type and model for more details.

  {{% alert title="Tip" color="tip" %}}

  Some optional attributes have default values.
  If you omit these attributes from your config, or if you include them but leave their values empty, `viam-server` will apply these default values at runtime, even though they are not reflected in the configuration file.

  {{% /alert %}}

- `depends_on`: Any components that a given component relies upon, and that must be initialized on boot before this component is initialized.
  Many built-in components have convenient implicit dependencies, in which case `depends_on` can be left blank.
  For example, a [`gpio` motor](/components/motor/gpio/) depends on the `board` to which it is wired, but it has a dedicated `board` attribute and `viam-server` will automatically initialize that board before it looks for the motor.

If you are configuring several similar components, you can use the **Duplicate component** button in the upper-right of a component's configuration pane to create a new identical component beneath your existing one.
Be sure to edit the duplicated component to change any parameters that are unique to the new component, such as its name and pins.

To delete a component, click the trash can icon in the upper-right of the component configuration pane.

For specific information on how to configure each supported component type, see the [components documentation](/components/).

{{% alert title="Tip" color="tip" %}}

When you configure a component on the **Config** tab, it will also appear on the **Control** tab which gives you an interface to test and interact with it.
Meanwhile the **Code sample** tab will also update to include code for some basic interaction with that component using the Viam [SDKs](/build/program/apis/).

{{<gif webm_src="/manage/control.webm" mp4_src="/manage/control.mp4" alt="Using the control tab">}}

{{% /alert %}}

## Services

[Services](/services/) are built-in software packages that make it easier to add complex capabilities such as motion planning or object detection to your machine.

For services, the `type` specifies which of the Viam services you want to use on your machine, such as the vision service or the motion service.

The `name` serves as an identifier when accessing the resource from your code, as well as when configuring other resources that are dependent on that resource.
You can choose any unique name for a service.

The other aspects of configuring a service are highly specific to the type of service.
See the [services documentation](/services/) for more information.

## Modules

[Modular resources](/registry/) are a way to add resource types or models that are not built into Viam.

To add a modular resource as a component or service of your machine, configure a module per the [modular resource documentation](/registry/).

## Remotes

Configuring a remote is a way to connect two separate machines so one can access the resources of the other.
Find more information in our [remotes documentation](/build/configure/parts-and-remotes/).

## Processes

To automatically run a specified script when the machine boots, configure a _process_.

Start by giving the process a **Name** (`id` in raw JSON) (an identifier of your choice) and clicking **Create process**.

Then fill in the following fields:

<!-- prettier-ignore -->
| Attribute (Builder Mode) | Attribute (Raw JSON) | Type    | Inclusion    | Description |
| ------------------------ | -------------------- | ------- | ------------ | ----------- |
| Executable               | `name`               | string  | **Required** | The command you want to execute when your machine connects to the server. |
| Arguments                | `args`               | string  | Optional     | Arguments to follow the command. |
| Working directory        | `cwd`                | string  | Optional     | Where you want the process to execute. Defaults to the directory where `viam-server` executes. |
| Logging                  | `log`                | boolean | Optional     | Toggle logging of errors and other messages on or off. Default: `false`. |
| Execute once             | `one_shot`           | boolean | Optional     | Toggle whether to execute the command just once or keep running the process indefinitely.<ul><li>If true, the process executes once at `viam-server` startup. Until the process completes, `viam-server` startup is blocked and the robot appears offline in the [Viam app](https://app.viam.com), so this should only be used for quick processes.</li><li>If false, the process continues to run. If the process crashes, it automatically restarts. It does not block `viam-server`. Default: `false`.</li></ul> |

{{% expand "Click to see an example of a configured process." %}}

The following configuration executes the command `python3 my_cool_script.py` in your <file>/home/myName/project/</file> directory every time your machine boots, and keeps it executing indefinitely.

![The PROCESSES subtab of the CONFIG tab with a process called run-my-code configured. The executable is python3, the argument is my_cool_script.py, and the working directory is /home/myName/project. Logging is turned on and execute once is turned off.](/build/configure/process-fancy.png)

The corresponding raw JSON looks like this:

```json
"processes": [
    {
      "id": "run-my-code",
      "log": true,
      "name": "python3",
      "args": [
        "my_cool_script.py"
      ],
      "cwd": "/home/myName/project/"
    }
  ]
```

{{% /expand %}}

## Webhooks

Webhooks allow you to trigger actions when certain types of data are sent from your machine to the cloud.
For example, you can configure a webhook to send you a notification when your robot's sensor collects a new reading.

Switch to **Raw JSON** mode to configure webhooks as follows:

1. Paste the following JSON template into your raw JSON config.
   `"webhooks"` is a top-level section like `"components"`, `"services"`, or any of the other config sections.

   {{< tabs >}}
   {{% tab name="JSON Template" %}}

```json {class="line-numbers linkable-line-numbers"}
  "webhooks": [
    {
      "url": "<Insert your own cloud function or lambda URL for sending the event>",
      "event": {
        "attributes": {
          "data_types": ["binary", "tabular", "file"]
        },
        "type": "part_data_ingested"
      }
    }
  ]
```

{{% /tab %}}
{{% tab name="JSON Example" %}}

```json {class="line-numbers linkable-line-numbers"}
{
  "components": [
    {
      "name": "local",
      "model": "rdk:builtin:pi",
      "type": "board",
      "namespace": "rdk",
      "attributes": {},
      "depends_on": []
    },
    {
      "name": "my_temp_sensor",
      "model": "rdk:builtin:bme280",
      "type": "sensor",
      "namespace": "rdk",
      "attributes": {},
      "depends_on": [],
      "service_configs": [
        {
          "type": "data_manager",
          "attributes": {
            "capture_methods": [
              {
                "method": "Readings",
                "additional_params": {},
                "capture_frequency_hz": 0.017
              }
            ]
          }
        }
      ]
    }
  ],
  "webhooks": [
    {
      "url": "https://1abcde2ab3cd4efg5abcdefgh10zyxwv.lambda-url.us-east-1.on.aws",
      "event": {
        "attributes": {
          "data_types": ["binary", "tabular"]
        },
        "type": "part_data_ingested"
      }
    }
  ]
}
```

{{% /tab %}}
{{< /tabs >}}

2. Replace the URL value with the URL of your cloud/lambda function.
3. Edit the `data_types` list to include only the types of data you want to trigger on.
4. Configure [data capture](/data/capture/) and [cloud sync](/data/cloud-sync/) for the relevant components.
   For example, if you want to trigger a webhook on temperature readings, configure data capture and sync on your temperature sensor.
   Be aware that the component must return the type of data you configured in `data_types`.
5. Write your cloud/lambda function to process the request from `viam-server`.
   The following example function sends a Slack message with a machine's details, such as robot and location IDs, when it receives a request:

   ```python {class="line-numbers linkable-line-numbers"}
   import functions_framework
   import requests
   import time

   @functions_framework.http
   def hello_http(request):
     payload = {
       "Org-ID": request.headers['org-id'] if 'org-id' in request.headers else 'no value',
       "Location-ID": request.headers['location-id'] if 'location-id' in request.headers else 'no value',
       "Part-ID": request.headers['part-id'] if 'part-id' in request.headers else 'no value',
       "Robot-ID": request.headers['robot-id'] if 'robot-id' in request.headers else 'no value'
     }

     slack_url = "<paste in your own Slack URL"
     headers = {}

     response = requests.post(slack_url, json=payload, headers=headers)

     request_json = request.get_json(silent=True)
     request_args = request.args

     return 'Sent request to {}'.format(slack_url)

   ```

## Fragments

You can use fragments to share similar {{< glossary_tooltip term_id="resource" text="resource" >}} configuration files across multiple machines in your fleet.
For example, if you have multiple machines with the same motor hardware, wired the same way, you can create a fragment to configure that motor and share it easily across all of your machines, without needing to individually configure the motor component for each machine.

See [Use Fragments to Configure a Fleet](/fleet/configure-a-fleet/) for more information on creating and deploying fragments.

## Auth/network

The auth section allows you to configure machine-level API keys for connecting over LAN.

The network section allows you to set the address `viam-server` binds to for accepting connections.
By default, `viam-server` binds to `0.0.0.0:8080` when managed by the Viam app or when authentication and TLS are enabled.

## Frame system

The frame system holds reference frame information for the relative position of components in space.

Configure a frame for a given component on its panel on the **Components** tab, then switch to the **Frame System** tab to visualize the relative positions.
Find more information in the [frame system documentation](/mobility/frame-system/).

## Troubleshooting

If you run into issues, here are some things to try:

- Check the [**Logs** tab](/fleet/machines/#logs) to view log messages and errors from `viam-server`.
  You can also [access the local log file](/get-started/installation/manage/#view-viam-server-logs) on your machine if needed.
- Make sure all configured components are actually saved to your config.
  If they aren't, you will see an **Unsaved Changes** note next to the **Save Config** button at the bottom of the config screen.
- Try restarting `viam-server` by clicking **Restart** in the upper right corner of the app.
  It takes a few minutes for the server to shut down and restart.
- Make sure the issue is not hardware related.
  Some things to check are that the machine has adequate power, all wires are properly connected, and no chips or other hardware components are shorted or overheated.
- See [Troubleshooting](/appendix/troubleshooting/) for additional troubleshooting steps.
- {{< snippet "social.md" >}}

## Local setup

Configuring `viam-server` with the Viam app allows you to make use of the cloud features of Viam:

- [Fleet Management](/fleet/)
- [Data Management](/data/)
- [Machine Learning](/ml/)

However, if you are configuring a machine that can never connect to the internet, you can create a [local configuration file](/internals/local-configuration-file/) on your machine.
A locally-configured machine will not be able to access Viam's cloud features.

## Next steps

After configuring your machine, you can use the [Viam SDKs](/build/program/apis/) to program and control your machine.

If you want to try configuring a machine but don't have any hardware on hand, try the [Build a Mock Robot](/tutorials/configure/build-a-mock-robot/) tutorial.
