---
title: "Configure a `TMC5072` motor"
linkTitle: "TMC5072"
weight: 50
type: "docs"
description: "How to configure a motor with model `TMC5072`"
# SMEs: Rand, James
---

This model supports stepper motors controlled by the [TMC5072 chip](https://www.trinamic.com/support/eval-kits/details/tmc5072-bob/).

Whereas a basic low-level stepper driver supported by the [`gpiostepper` model](/components/motor/gpiostepper/) sends power to a stepper motor based on PWM signals from GPIO pins, the TMC5072 chip uses SPI bus to communicate with the board, does some processing on the chip itself, and provides convenient features including StallGuard2<sup>TM</sup>.

An example configuration for a `tmc5072` motor driver and the [board](/components/board/) it's wired to:

{{< tabs >}}
{{% tab name="Builder UI" %}}

![Config panel for a TMC5072 motor with attributes filled in according to the Raw JSON tab.](../../img/motor/tmc5072-config-ui.png)

{{% /tab %}}
{{% tab name="Raw JSON" %}}

```json
{
  "components": [
    {
      "name": "example-board",
      "type": "board",
      "model": "pi"
    },
    {
      "name": "my-tmc-motor",
      "type": "motor",
      "model": "TMC5072",
      "attributes": {
        "chip_select": "36",
        "index": 0,
        "max_acceleration": 10000,
        "max_rpm": 450,
        "spi_bus": "main",
        "ticks_per_rotation": 200,
        "board": "example-board"
      }
    }
  ]
}
```

{{% /tab %}}
{{< /tabs >}}

#### Required Attributes

Name | Type | Description
-------------- | ---- | ---------------
`board` | string | Should match name of board to which the motor controller is wired.
`spi_bus` | string | The board SPI bus over which the TMC chip communicates with the board.
`chip_select` | string | The pin number of the GPIO pin on the board wired to the TMC controller. The board sets this high or low to let the TMC chip know whether to listen for commands over SPI.
`index` | int | The index of the SPI bus. For example, on a Raspberry Pi a user could use SPI bus "0" or "1."
`ticks_per_rotation` | integer | Number of full steps in a rotation. 200 (equivalent to 1.8 degrees per step) is very common.

#### Optional Attributes

Name | Type | Description
-------------- | ---- | ---------------
`max_acceleration_rpm_per_sec` | float64 | Set a limit on maximum acceleration in revolutions per minute per second.
`sg_thresh` | int32 | Stallguard threshold; sets sensitivity of virtual endstop detection when homing.
`home_rpm` | float64 | Speed in revolutions per minute that the motor will turn when executing a Home() command (via DoCommand() since not part of standard motor API)
`cal_factor` | float64 | Calibration factor for velocity and acceleration. Compensates for clock source drift when doing time-based calculations.
`run_current` | int32 | Set current when motor is turning, from 1-32 as a percentage of rsense voltage. Defaults to 15 if omitted or set to 0.
`hold_current` | int32 | Set current when motor is holding a position, from 1-32 as a percentage of rsense voltage. Defaults to 8 if omitted or set to 0.
`hold_delay` | int32 | How long to hold full power at a set position before ramping down to `hold_current`. 0=instant powerdown, 1-15=delay * 2^18 clocks, 6 is the default.
